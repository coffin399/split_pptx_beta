# PPTX Script Slide Generator

PowerPoint の「ノート欄」に書かれた文字を、読み上げ用の大きな黒背景スライドに作り直すツールです。ボタンを押すだけで自動変換できるので、パソコン操作に不慣れな方でも安心して使えます。

---

## このアプリでできること

- ノート欄の文章を自動で読みやすい長さ（約200文字）ごとに分割
- 話者ごとに文字色を自動変更（話者1: 黄色 / 話者2: シアン / 話者3: 緑）
- 黒い背景・大きな文字（メイリオ 40pt）で表示
- ノートが長いときは 1/2, 2/2 のようにページ番号を右下に表示
- 右下に元スライドのサムネイルを自動で挿入（内部レンダリングに失敗した場合のみダミー画像を使用）
- 出力ファイル名は「スクリプトスライド_自動生成.pptx」で固定

---

## はじめに（アプリの準備）

1. GitHub の「Releases」ページからお使いのパソコンに合ったファイルをダウンロードします。
   - Windows: `pptx_script_slides.exe`
   - macOS: `pptx_script_slides-macos.zip`
2. ダウンロードした ZIP ファイルをダブルクリックして解凍します。
3. 解凍してできたフォルダの中にあるアプリを使います。
   - Windows: `pptx_script_slides.exe`
   - macOS: `PPTXScriptSlides.app`

> **GUI について**: アプリは PySide6 (Qt for Python) を利用しています。ソースコードからセットアップする場合は `pip install PySide6` を実行してください。

> **ヒント**: macOS の場合、初回起動時に「開発元が未確認」と表示されたら、システム設定 → プライバシーとセキュリティで「開く」を選択してください。

---

## 使い方（手順）

1. アプリをダブルクリックで起動します。
2. 画面左上の「PowerPointファイルを選んで変換してください。」という案内を確認します。
3. 「入力 PPTX」の欄の右にある【参照】ボタンを押し、変換したい PowerPoint ファイル（.pptx）を選びます。
4. （必要に応じて）「出力フォルダ」の欄で保存先を指定します。指定しない場合は、元の PowerPoint と同じ場所に保存されます。
5. 【変換】ボタンを押します。
6. 画面下のログ欄に処理の進行状況が表示されます。完了すると「処理が完了しました。」と表示されます。
7. 保存先フォルダに「スクリプトスライド_自動生成.pptx」が作成されているので開いてご確認ください。

---

## 出力されるスライドのイメージ

- 背景は黒、文字は大きなメイリオ 40pt
- 話者名があれば自動で判定して色分け
- 1枚に入りきらない長文は自動で複数枚に分割（右下に 1/2, 2/2 などを表示）
- 右下に元スライドのサムネイル画像を表示（サムネイル生成ができない環境ではプレースホルダー画像を挿入）

---

## よくある質問（FAQ）

**Q. ノート欄が空のスライドはどうなりますか？**  
A. ノート欄に何も書かれていないスライドはスキップします。

**Q. 話者の色分けはどうやって指定しますか？**  
A. ノート欄に `話者1：こんにちは` のように書くと自動判定されます。全角でも半角でも「話者1:」「話者1：」と書けばOKです。

**Q. 句読点がない長文でも分割されますか？**  
A. はい。句読点を優先しますが、無い場合は200文字ごとに自動で分割します。

**Q. サムネイル画像が灰色のままです。**  
A. アプリは PowerPoint の内容をその場で描画してサムネイルを作成します。個別スライドの描画に失敗した場合のみダミー画像になります。繰り返し発生する場合は PowerPoint の内容を簡略化する、画像形式を変える、または LibreOffice（soffice）をインストールしてから再実行してください。

**Q. エラーが出たときはどうすれば良いですか？**  
A. ログ欄に表示されるメッセージをご確認ください。それでも解決しない場合は、元の PowerPoint ファイルをコピーして別の場所に保存し直すか、PowerPoint を開いて保存し直してから再度お試しください。

**Q. 画面の色が説明と違います。**  
A. PySide6 版では OS のテーマ設定に合わせた外観になります。表示が崩れる場合は最新のグラフィックドライバーを利用しているか確認し、改善しない場合はお知らせください。

---

## 困ったときの確認ポイント

- PowerPoint ファイルの形式が .pptx になっているか
- ファイルが他のアプリで開きっぱなしになっていないか
- 出力先フォルダに書き込み権限があるか
- 文字化けする場合は、ノート欄のフォントを標準的な日本語フォント（メイリオなど）にして保存し直してください

---

## 開発者向け情報（必要な方のみ）

### 動作要件

- **Python**: 3.8 - 3.13 （Python 3.14 は現在非対応）
- **OS**: Windows / macOS
- **配布バイナリ**: Python 3.10 + PySide6 でビルドされています（ランタイム内包済みで Python 不要）

### ローカル開発環境のセットアップ

```bash
# Python 3.13 以下を使用してください / Please use Python 3.13 or earlier
python --version

# 仮想環境の作成 / Create virtual environment
python -m venv .venv
.venv\Scripts\activate         # Windows
source .venv/bin/activate       # macOS

# 依存関係のインストール / Install dependencies
pip install -r requirements.txt
```

> **重要**: GUI は PySide6 (Qt) を使用しており、Python 3.14 ではテストしていません。Python 3.8〜3.13 の環境をご利用ください。
> 
> **サムネイルについて**: Windows では PowerPoint + pywin32、macOS では PowerPoint + osascript を利用できる場合に自動で実スライド画像を取得します。インストールされていない環境では内部レンダリングまたはプレースホルダーにフォールバックします。

### アプリの起動

```bash
python app.py
```

### ビルド・リリースフロー

- `main` ブランチに push すると GitHub Actions が自動的に Windows / macOS 向けに Nuitka ビルドを実行します
- すべて成功した場合、既存の `latest` タグとリリースを削除したうえで最新の成果物で再作成します
- ワークフロー定義は `.github/workflows/build-release.yml` にあります（手動実行も可能）

---

## ライセンス

MIT License
